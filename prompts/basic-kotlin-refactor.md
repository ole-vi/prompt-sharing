Refactor the Kotlin codebase and create 10 task stubs with the following goals:

- **Remove duplication**
- **Enforce idiomatic Kotlin** (use `map`, `filter`, `forEach` instead of manual loops)
- **Introduce extension functions** where repeated patterns exist
- **Prefer `val` over `var`** and immutable collections
- **Simplify control flow** with sealed classes or enums when applicable
