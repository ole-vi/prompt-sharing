<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OLE Prompt Library</title>
  <link rel="stylesheet" href="src/styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-functions-compat.js"></script>
  <script src="firebase-init.js"></script>
</head>
<body>
  <header>
    <div style="max-width:1100px; margin:0 auto; display:flex; justify-content:space-between; align-items:flex-start; gap:12px; padding:0 16px;">
      <!-- Auth buttons - top right -->
      <div id="authStatus" style="display:flex; flex-direction:column; align-items:flex-end; gap:4px; font-size:13px; order:2;">
        <div style="display:flex; gap:8px;">
          <button class="btn" id="authBtn" style="padding:6px 10px; font-size:12px;">Sign in with GitHub</button>
          <button class="btn" id="signOutBtn" style="padding:6px 10px; font-size:12px; background:#e74c3c; color:white; display:none;" title="Sign out">Sign Out</button>
        </div>
        <span id="userDisplay" style="display:none; font-size:11px; color:var(--muted);">
          <strong id="userName"></strong>
        </span>
      </div>
      
      <!-- Logo and description - left side -->
      <div style="flex:1; order:1;">
        <a href="https://ole-vi.github.io/prompt-sharing/" style="text-decoration:none; color:inherit;">
          <div style="font-size:18px; font-weight:800; letter-spacing:0.2px;">OLE Prompt Library</div>
        </a>
        <div style="color:var(--muted); font-size:13px;">Single file, no build. Drop .md files in <code>/prompts</code> and they show up here.</div>
      </div>
    </div>
    
    <!-- Branch and repo controls - second row -->
    <div style="max-width:1100px; margin:8px auto 0; display:flex; justify-content:flex-end; gap:8px; padding:0 16px; align-items:center;">
      <div class="pill" id="repoPill">Loading repo...</div>
      <label style="display:flex; align-items:center; gap:4px;">
        <span title="Choose a branch">‚ñº</span>
        <select id="branchSelect" class="btn" style="min-width:140px;">
          <option>Loading branches‚Ä¶</option>
        </select>
      </label>
    </div>
  </header>

  <div class="wrap">
    <aside id="sidebar" class="card">
      <input id="search" placeholder="Search prompts..." />
      <div id="list"></div>
      <div style="padding:8px 6px; color:var(--muted); font-size:12px;">
        Add prompts by committing <code>.md</code> files to <code>/prompts</code> in your repo. Use a first-level heading for the title.
      </div>
    </aside>

    <main id="main" class="card">
      <div id="empty">Select a prompt from the list. You can deep link to any prompt using the URL hash.</div>
      <h1 id="title" style="display:none"></h1>
      <div id="meta" style="display:none"></div>
      <div id="actions" style="display:none">
        <button class="btn" id="copyBtn" title="Copy the entire prompt">üìã Copy prompt</button>
        <button class="btn" id="shareBtn" title="Copy a link to this prompt">üîó Copy link</button>
        <button class="btn" id="julesBtn" title="Try this prompt in Jules">‚ö° Try in Jules</button>
        <a class="btn" id="editBtn" target="_blank" rel="noopener" title="Edit the file on GitHub">‚úèÔ∏è Edit on GitHub</a>
        <a class="btn" id="ghBtn" target="_blank" rel="noopener" title="Open the file on GitHub">üóÇÔ∏è View on GitHub</a>
        <a class="btn" id="rawBtn" target="_blank" rel="noopener" title="Open raw markdown">üìÑ Open raw</a>
      </div>
      <article id="content"></article>
    </main>
  </div>

  <footer>
    <div>Switch branches/owners/repos via URL or the dropdown. Examples: <code>?branch=Jesse</code> or <code>?owner=ole-vi&repo=prompt-sharing&branch=main</code>.</div>
  </footer>

  <!-- Jules API Key Modal -->
  <div id="julesKeyModal" style="display:none !important; position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.7); z-index:1000; align-items:center; justify-content:center;">
    <div style="background:var(--card); border:1px solid var(--border); border-radius:14px; padding:20px; max-width:400px; width:90%; box-shadow:0 8px 24px rgba(0,0,0,0.4);">
      <h2 style="margin:0 0 12px; font-size:18px;">Save Jules API Key</h2>
      <p style="margin:0 0 16px; color:var(--muted); font-size:13px;">Enter your Jules API key. This will be encrypted and stored securely.</p>
      <input id="julesKeyInput" type="password" placeholder="Paste your Jules API key..." style="width:100%; padding:10px 12px; border:1px solid var(--border); border-radius:8px; background:#12162a; color:var(--text); outline:none; margin-bottom:16px; box-sizing:border-box;" />
      <div style="display:flex; gap:8px; justify-content:flex-end;">
        <button id="julesCancelBtn" class="btn" style="padding:8px 12px;">Cancel</button>
        <button id="julesSaveBtn" class="btn" style="padding:8px 12px; border-color:var(--accent); color:var(--accent);">Save & Continue</button>
      </div>
    </div>
  </div>

  <script type="module" src="src/app.js"></script>
</body>
</html>
